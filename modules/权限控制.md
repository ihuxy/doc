## 权限控制


```
const permRouter=(routers,permList,permKey='path')=>{
  return routers.map(router=>{
    if(router.children?.length){
      router.children=permRouter(router.children,permList,permKey);
    }
    router.denied=router.denied||router[permKey]&&!permList.includes(router[permKey]);
    return router;
  });
};

```

```
const App=()=>{
  const [permission,setPermission]=useState(null);
  useEffect(()=>{
    const getPerm=async ()=>{
      try{
        const {permList}=await permissionFn({time:+new Date()});
        setPermission(permList);
      }catch(err){
        setPermission([]);
      }
    };
    getPerm();
  },[]);
  if(!permission){
    return <Skeleton />;
  }
  if(!permission.length){
    return <Result
      status="403"
      title="403"
      subTitle="Sorry, you are not authorized to access this page."
      extra={<Button type="primary">Back Home</Button>}
    />;
  }
  return <Router permission={permission} />;
};

```

```
const {components,loading,store,updateRouter}=useRouter({...configs,...props,routers:permRouter(routers,permission)});
```



































